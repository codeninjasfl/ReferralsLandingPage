<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Code Ninjas Free Private Class & $100 Savings</title>
  <meta name="theme-color" content="#2563eb" />
  <style>
    :root {
      --bg1:#0ea5e9;
      --bg2:#2563eb;
      --card:#ffffff;
      --ink:#0f172a;
      --muted:#64748b;
      --brand:#2563eb;
      --accent:#22d3ee;
      --border:#e5e7eb;
      --radius:16px;
      --radius-xl:22px;
      --shadow:0 12px 30px rgba(2,6,23,.18), 0 2px 8px rgba(2,6,23,.08);
      --shadow-soft:0 14px 40px rgba(15,23,42,.20), 0 3px 10px rgba(15,23,42,.10);
      --font-sans:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif;
      --transition-fast:0.18s ease-out;
    }

    * { box-sizing:border-box; }

    html, body {
      margin:0;
      min-height:100%;
      font-family:var(--font-sans);
      color:var(--ink);
      background:linear-gradient(180deg,var(--bg1),var(--bg2));
      background-repeat:no-repeat;
      background-attachment:fixed;
      background-size:cover;
    }

    .page-wrap {
      min-height:100svh;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:22px 16px 32px;
      gap:14px;
    }

    header {
      color:#eef6ff;
      text-align:center;
    }

    header .brand {
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
    }

    header img.logo {
      height:40px;
      width:auto;
      filter:drop-shadow(0 1px 0 rgba(0,0,0,.18));
    }

    header h1 {
      margin:10px 0 4px;
      font-size:clamp(24px,4.4vw,34px);
      font-weight:900;
    }

    header p.sub {
      margin:0;
      font-size:clamp(13px,2.3vw,16px);
      color:#dbeafe;
    }

    .layout {
      width:min(640px,100%);
      margin:0 auto;
      display:flex;
      flex-direction:column;
      gap:14px;
      align-items:stretch;
    }

    .card {
      background:var(--card);
      border-radius:var(--radius-xl);
      border:1px solid var(--border);
      box-shadow:var(--shadow);
      padding:18px 18px 20px;
    }

    .hero-copy h2 {
      margin:0 0 8px;
      font-size:20px;
      font-weight:800;
      color:#0f172a;
    }

    .hero-copy p {
      margin:4px 0 10px;
      color:var(--muted);
      font-size:14px;
    }

    .highlight {
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 11px;
      border-radius:999px;
      background:rgba(37,99,235,0.07);
      color:#1d4ed8;
      font-weight:700;
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.08em;
      margin-bottom:6px;
    }

    .form-card h2 {
      margin:0 0 4px;
      font-size:17px;
      font-weight:800;
      color:#0f172a;
    }

    .form-card p {
      margin:0 0 8px;
      font-size:11px;
      color:var(--muted);
    }

    form {
      display:flex;
      flex-direction:column;
      gap:7px;
      margin-top:4px;
    }

    .field-group-label {
      margin:8px 0 2px;
      font-size:10px;
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:.14em;
      color:#9ca3af;
    }

    .field {
      display:flex;
      flex-direction:column;
      gap:3px;
      font-size:10px;
    }

    .field label {
      font-weight:600;
      color:#6b7280;
    }

    select, input {
      width:100%;
      padding:9px 10px;
      border-radius:11px;
      border:1px solid var(--border);
      font-size:11px;
      font-family:var(--font-sans);
      outline:none;
      transition:border-color var(--transition-fast), box-shadow var(--transition-fast), background-color var(--transition-fast), opacity var(--transition-fast);
      background:#ffffff;
    }

    select:focus, input:focus {
      border-color:var(--brand);
      box-shadow:0 0 0 2px rgba(37,99,235,0.1);
      background:#f9fafb;
    }

    .primary-btn {
      margin-top:10px;
      padding:10px 14px;
      border-radius:14px;
      border:none;
      background:linear-gradient(90deg,var(--brand),var(--accent));
      color:#ffffff;
      font-weight:800;
      font-size:12px;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      box-shadow:var(--shadow-soft);
      transition:transform var(--transition-fast), box-shadow var(--transition-fast), filter var(--transition-fast), opacity var(--transition-fast);
    }

    .primary-btn .kicker {
      font-size:9px;
      font-weight:600;
      opacity:0.92;
      text-transform:uppercase;
      letter-spacing:.16em;
    }

    .primary-btn:hover:not([disabled]) {
      transform:translateY(-1px);
      box-shadow:0 18px 40px rgba(15,23,42,.25);
      filter:brightness(1.03);
    }

    .primary-btn:active:not([disabled]) {
      transform:translateY(0px);
      box-shadow:var(--shadow-soft);
      filter:brightness(.99);
    }

    .primary-btn[disabled] {
      opacity:0.5;
      cursor:not-allowed;
      box-shadow:none;
    }

    .tiny-note {
      margin-top:4px;
      font-size:8px;
      color:#9ca3af;
      text-align:left;
    }

    .reward-banner {
      margin-top:4px;
      padding:7px 9px;
      border-radius:12px;
      background:#eff6ff;
      border:1px solid #dbeafe;
      font-size:9px;
      color:#1d4ed8;
      display:flex;
      align-items:center;
      gap:6px;
      font-weight:600;
    }

    .reward-banner .icon { font-size:12px; }

    @media (max-width:768px) {
      .page-wrap { padding:14px 10px 20px; }
      header img.logo { height:32px; }
      header h1 { font-size:22px; }
      header p.sub { font-size:12px; }
      .card { padding:14px 14px 16px; border-radius:18px; }
    }

    @media (max-width:520px) {
      header h1 { font-size:20px; }
      .reward-banner { align-items:flex-start; }
    }

    @media (min-width:1024px) {
      .layout { width:min(760px,100%); }
      header h1 { font-size:36px; }
      header p.sub { font-size:16px; }
      .hero-copy h2 { font-size:24px; }
      .hero-copy p { font-size:15px; }
      .form-card h2 { font-size:20px; }
      .form-card p { font-size:13px; }
      .field-group-label { font-size:11px; }
      .field { font-size:11px; }
      select, input { font-size:12px; padding:10px 11px; }
      .tiny-note { font-size:9px; }
    }
  </style>
</head>
<body>
  <div class="page-wrap">
    <header>
      <div class="brand">
        <img class="logo" src="https://www.codeninjas.com/hubfs/Group%201.svg" alt="Code Ninjas logo" onerror="this.style.display='none'">
      </div>
      <h1>Code Ninjas Referral Program</h1>
      <p class="sub">Schedule a free private game-building session and unlock <strong>$100 off</strong> when you enroll.</p>
    </header>

    <main class="layout">
      <section class="card hero-copy" aria-label="Free private class overview">
        <div class="highlight">
          <span>$0 Private Class + $100 Off</span>
        </div>
        <h2>Schedule a free private class!</h2>
        <p>
          And if you enroll in a qualifying program at your selected dojo after your free private class, you receive <strong>$100 off your first month</strong>.
        </p>
      </section>

      <section class="card form-card" aria-label="Free private class form">
        <h2>Claim Your Free Private Class</h2>
        <p>Complete this quick form and then book your time instantly.</p>

        <form id="referral-form">
          <input type="hidden" name="access_key" value="a7083fda-1e4f-4c29-aafd-d5a5c5929932" />
          <input type="hidden" id="subject" name="subject" value="Code Ninjas Free Private Class" />

          <div class="field-group-label">Your Info</div>
          <div class="field">
            <label for="guest-name">Your Name*</label>
            <input id="guest-name" name="guestName" required />
          </div>

          <div class="field-group-label">Who Referred You?</div>
          <div class="field">
            <label for="ref-parent-name">Referring Parent's Name (Who's Social Media did you get this site from?)*</label>
            <input id="ref-parent-name" name="refParentName" required />
          </div>

          <div class="field-group-label">Preferred Dojo</div>
          <div class="field">
            <label for="ref-location">Preferred Dojo*</label>
            <select id="ref-location" name="refLocation" required>
              <option value="" disabled selected>Select your location</option>
              <option value="Aventura">Aventura</option>
              <option value="Cooper City">Cooper City</option>
              <option value="Weston">Weston</option>
            </select>
          </div>

          <button type="submit" class="primary-btn" id="schedule-btn" disabled>
            <div>
              <div class="kicker">Locked until everything is filled out</div>
              <div>Schedule a free private class now!</div>
            </div>
            <span>▶</span>
          </button>

          <div class="tiny-note">
            Select your preferred dojo to unlock scheduling. Your info helps us track your savings as part of our referral program.
          </div>
          <div id="form-status" aria-live="polite" style="margin-top:6px; font-size:9px;"></div>
        </form>
      </section>
    </main>
  </div>

  <script>
    // Toggle API submission on/off for debugging.
    // true = send to Web3Forms + open dojo link
    // false = skip API call, just open dojo link as if successful
    const USE_API = true;

    (function () {
      const form = document.getElementById('referral-form');
      const dojoSelect = document.getElementById('ref-location');
      const guestNameInput = document.getElementById('guest-name');
      const refParentInput = document.getElementById('ref-parent-name');
      const subjectInput = document.getElementById('subject');
      const submitBtn = document.getElementById('schedule-btn');
      const kicker = submitBtn ? submitBtn.querySelector('.kicker') : null;
      const statusEl = document.getElementById('form-status');

      if (!form || !dojoSelect || !submitBtn || !subjectInput) return;

      const dojoUrls = {
        'Aventura': 'https://www.codeninjas.com/fl-aventura',
        'Cooper City': 'https://www.codeninjas.com/fl-cooper-city',
        'Weston': 'https://www.codeninjas.com/fl-weston'
      };

      // Enable/disable button based on dojo + names
      function updateButtonState() {
        const dojo = dojoSelect.value;
        const hasDojo = dojo && dojoUrls[dojo];
        const hasGuest = (guestNameInput?.value || '').trim().length > 0;
        const hasRef = (refParentInput?.value || '').trim().length > 0;

        if (hasDojo && hasGuest && hasRef) {
          submitBtn.disabled = false;
          submitBtn.style.opacity = '1';
          submitBtn.style.cursor = 'pointer';
          if (kicker) kicker.textContent = 'Ready to schedule';
        } else {
          submitBtn.disabled = true;
          submitBtn.style.opacity = '0.5';
          submitBtn.style.cursor = 'not-allowed';
          if (kicker) kicker.textContent = 'Locked until everything is filled out';
        }
      }

      dojoSelect.addEventListener('change', updateButtonState);
      if (guestNameInput) guestNameInput.addEventListener('input', updateButtonState);
      if (refParentInput) refParentInput.addEventListener('input', updateButtonState);

      // Set initial state
      updateButtonState();

      form.addEventListener('submit', async function (e) {
        e.preventDefault();

        const dojo = dojoSelect.value;
        const scheduleUrl = dojoUrls[dojo];

        if (!dojo || !scheduleUrl) {
          if (statusEl) {
            statusEl.textContent = 'Please select your preferred dojo before scheduling.';
            statusEl.style.color = '#b91c1c';
          }
          return;
        }

        const accessKeyInput = form.querySelector('input[name="access_key"]');
        const accessKey = accessKeyInput ? accessKeyInput.value : '';

        const guestName = (document.getElementById('guest-name')?.value || '').trim();
        const refParentName = (document.getElementById('ref-parent-name')?.value || '').trim();

        subjectInput.value = 'Code Ninjas Free Private Class - ' + dojo;

        if (!guestName || !refParentName) {
          if (statusEl) {
            statusEl.textContent = 'Please complete all required fields.';
            statusEl.style.color = '#b91c1c';
          }
          return;
        }

        if (statusEl) {
          statusEl.textContent = 'Submitting your details...';
          statusEl.style.color = '#2563eb';
        }

        submitBtn.disabled = true;
        submitBtn.style.opacity = '0.9';
        submitBtn.style.cursor = 'default';
        if (kicker) kicker.textContent = 'Submitting...';

        let message = `A new Free Private Class referral entry has been submitted.\n\n` +
          `Your Name: ${guestName}\n` +
          `Referring Parent's Name (Social Media Source): ${refParentName}\n` +
          `Preferred Dojo: ${dojo}\n\n` +
          `Offer Details:\n` +
          `This submission is part of the Code Ninjas referral program. The family is directed to schedule a free private game-building class at their selected dojo. ` +
          `When they enroll in a qualifying program after their free private class, they receive $100 off their next full month, and the referring family may also receive a $100 credit, per location policy.`;

        const payload = new FormData();
        if (accessKey) payload.append('access_key', accessKey);
        payload.append('subject', subjectInput.value);
        payload.append('from_name', guestName || 'Code Ninjas Free Class Form');
        payload.append('message', message);

        try {
          if (!USE_API) {
            // Debug mode: skip API call, behave as if successful
            if (statusEl) {
              statusEl.textContent = 'Debug mode: no data sent. Opening your selected dojo page in a new tab.';
              statusEl.style.color = '#16a34a';
            }

            Array.from(form.elements).forEach(el => {
              if (el.tagName === 'BUTTON') return;
              if (el.tagName === 'SELECT') {
                el.disabled = true;
              } else {
                el.readOnly = true;
              }
            });

            const icon = submitBtn.querySelector('span:last-child');
            if (icon) icon.textContent = '✓';
            if (kicker) kicker.textContent = 'Submitted (Debug)';

            window.location.href = scheduleUrl;
            return;
          }

          const response = await fetch('https://api.web3forms.com/submit', {
            method: 'POST',
            body: payload,
            headers: { 'Accept': 'application/json' }
          });

          const data = await response.json().catch(() => ({}));
          console.log('Web3Forms response:', data);

          if (response.ok && (data.success !== false)) {
            if (statusEl) {
              statusEl.textContent = 'Form submitted! Opening your selected dojo page in a new tab so you can schedule your free private class.';
              statusEl.style.color = '#16a34a';
            }

            Array.from(form.elements).forEach(el => {
              if (el.tagName === 'BUTTON') return;
              if (el.tagName === 'SELECT') {
                el.disabled = true;
              } else {
                el.readOnly = true;
              }
            });

            const icon = submitBtn.querySelector('span:last-child');
            if (icon) icon.textContent = '✓';
            if (kicker) kicker.textContent = 'Submitted';

            window.location.href = scheduleUrl;
          } else {
            throw new Error(data.message || 'Submission failed');
          }
        } catch (err) {
          console.error('Submission error:', err);

          if (statusEl) {
            statusEl.textContent = 'Something went wrong submitting your details. Please try again.';
            statusEl.style.color = '#b91c1c';
          }

          submitBtn.disabled = false;
          submitBtn.style.opacity = '1';
          submitBtn.style.cursor = 'pointer';
          if (kicker) kicker.textContent = 'Ready to schedule';
          const icon = submitBtn.querySelector('span:last-child');
          if (icon) icon.textContent = '▶';
        }
      });
    })();
  </script>
</body>
</html>
